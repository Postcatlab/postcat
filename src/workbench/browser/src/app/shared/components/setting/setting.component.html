<a class="sidebar_item sidebar_setting" title="设置" (click)="handleShowModal()" *ngIf="isVisible">
  <i nz-icon nzType="setting"></i>
</a>

<nz-modal [(nzVisible)]="isVisible && isModal" nzWidth="70%" nzTitle="配置" (nzOnCancel)="handleCancel()">
  <section *nzModalContent>
    <form nz-form [nzLayout]="'vertical'" [formGroup]="validateForm" (ngSubmit)="handleSave()" class="flex">
      <nz-tree-view [nzTreeControl]="treeControl" [nzDataSource]="dataSource" style="margin-right: 20px;">
        <nz-tree-node *nzTreeNodeDef="let node" nzTreeNodePadding>
          <nz-tree-node-toggle nzTreeNodeNoopToggle></nz-tree-node-toggle>
          <nz-tree-node-option [nzDisabled]="node.disabled" [nzSelected]="selectListSelection.isSelected(node)"
            (nzClick)="selectModule(node)">
            {{ node.title }}
          </nz-tree-node-option>
        </nz-tree-node>

        <nz-tree-node *nzTreeNodeDef="let node; when: hasChild" nzTreeNodePadding>
          <nz-tree-node-toggle>
            <i nz-icon nzType="caret-down" nzTreeNodeToggleRotateIcon></i>
          </nz-tree-node-toggle>
          <nz-tree-node-option [nzDisabled]="node.disabled" [nzSelected]="selectListSelection.isSelected(node)"
            (nzClick)="selectModule(node)">
            {{ node.title }}
          </nz-tree-node-option>
        </nz-tree-node>
      </nz-tree-view>
      <!-- <nz-tabset [nzTabPosition]="position">
        <nz-tab *ngFor="let module of modules" [nzTitle]="getModuleTitle(module)"> -->
      <div>
        <div *ngFor="let module of currentConfiguration">
          <h2 class="title">{{ module.title }}</h2>
          <nz-form-item nz-col class="fg1" *ngFor="let item of module.properties | keyvalue">
            <nz-form-label nzFor="{{ item.key }}">{{ module.properties[item.key]?.label }} </nz-form-label>
            <nz-form-control nzErrorTip="请输入 {{  module.properties[item.key] }}">
              <!-- 字符串类型 -->
              <ng-container *ngIf="module.properties[item.key]?.type === 'string'">
                <input type="text" nz-input id="{{ item.key }}"
                  placeholder="{{module.properties[item.key]?.placeholder}}" formControlName="{{ item.key }}"
                  [(ngModel)]="settings[item.key]" />
              </ng-container>

              <!-- 布尔类型 -->
              <ng-container *ngIf="module.properties[item.key]?.type === 'boolean'">
                <label nz-checkbox [(ngModel)]="settings[item.key]" id="{{ item.key }}"
                  formControlName="{{ item.key }}">{{module.properties[item.key]?.description}}</label>
              </ng-container>

              <!-- 数字类型 -->
              <ng-container *ngIf="module.properties[item.key]?.type === 'number'">
                <nz-input-number [(ngModel)]="settings[item.key]" id="{{ item.key }}" formControlName="{{ item.key }}">
                  {{module.properties[item.key]?.description}}</nz-input-number>
              </ng-container>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
      <!-- </nz-tab>
      </nz-tabset> -->
    </form>
  </section>
  <div *nzModalFooter class="footer">
    <button nz-button nzType="primary" (click)="handleSave()">保存</button>
    <button nz-button nzType="default" (click)="handleCancel()">取消</button>
  </div>
</nz-modal>
